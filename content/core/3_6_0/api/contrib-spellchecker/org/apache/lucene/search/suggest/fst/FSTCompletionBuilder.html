<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_01) on Wed Apr 11 21:47:34 EDT 2012 -->
<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
<title>FSTCompletionBuilder (Lucene 3.6.0 API)</title>
<meta name="date" content="2012-04-11">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="FSTCompletionBuilder (Lucene 3.6.0 API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/FSTCompletionBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.Completion.html" title="class in org.apache.lucene.search.suggest.fst"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionLookup.html" title="class in org.apache.lucene.search.suggest.fst"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html" target="_top">Frames</a></li>
<li><a href="FSTCompletionBuilder.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.lucene.search.suggest.fst</div>
<h2 title="Class FSTCompletionBuilder" class="title">Class FSTCompletionBuilder</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.lucene.search.suggest.fst.FSTCompletionBuilder</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">FSTCompletionBuilder</span>
extends <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">Finite state automata based implementation of "autocomplete" functionality.
 
 <h2>Implementation details</h2>
 
 <p>
 The construction step in <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang"><code>Object.finalize()</code></a> works as follows:
 <ul>
 <li>A set of input terms and their buckets is given.</li>
 <li>All terms in the input are prefixed with a synthetic pseudo-character
 (code) of the weight bucket the term fell into. For example a term
 <code>abc</code> with a discretized weight equal '1' would become
 <code>1abc</code>.</li>
 <li>The terms are then sorted by their raw value of UTF-8 character values
 (including the synthetic bucket code in front).</li>
 <li>A finite state automaton (<code>FST</code>) is constructed from the input. The
 root node has arcs labeled with all possible weights. We cache all these
 arcs, highest-weight first.</li>
 </ul>
 
 <p>
 At runtime, in <a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.html#lookup(java.lang.CharSequence, int)"><code>FSTCompletion.lookup(CharSequence, int)</code></a>, 
 the automaton is utilized as follows:
 <ul>
 <li>For each possible term weight encoded in the automaton (cached arcs from
 the root above), starting with the highest one, we descend along the path of
 the input key. If the key is not a prefix of a sequence in the automaton
 (path ends prematurely), we exit immediately -- no completions.</li>
 <li>Otherwise, we have found an internal automaton node that ends the key.
 <b>The entire subautomaton (all paths) starting from this node form the key's
 completions.</b> We start the traversal of this subautomaton. Every time we
 reach a final state (arc), we add a single suggestion to the list of results
 (the weight of this suggestion is constant and equal to the root path we
 started from). The tricky part is that because automaton edges are sorted and
 we scan depth-first, we can terminate the entire procedure as soon as we
 collect enough suggestions the user requested.</li>
 <li>In case the number of suggestions collected in the step above is still
 insufficient, we proceed to the next (smaller) weight leaving the root node
 and repeat the same algorithm again.</li>
 </ul>
 
 <h2>Runtime behavior and performance characteristic</h2>
 
 The algorithm described above is optimized for finding suggestions to short
 prefixes in a top-weights-first order. This is probably the most common use
 case: it allows presenting suggestions early and sorts them by the global
 frequency (and then alphabetically).
 
 <p>
 If there is an exact match in the automaton, it is returned first on the
 results list (even with by-weight sorting).
 
 <p>
 Note that the maximum lookup time for <b>any prefix</b> is the time of
 descending to the subtree, plus traversal of the subtree up to the number of
 requested suggestions (because they are already presorted by weight on the
 root level and alphabetically at any node level).
 
 <p>
 To order alphabetically only (no ordering by priorities), use identical term
 weights for all terms. Alphabetical suggestions are returned even if
 non-constant weights are used, but the algorithm for doing this is
 suboptimal.
 
 <p>
 "alphabetically" in any of the documentation above indicates UTF-8
 representation order, nothing else.
 
 <p>
 <b>NOTE</b>: the FST file format is experimental and subject to suddenly
 change, requiring you to rebuild the FST suggest index.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst"><code>FSTCompletion</code></a></dd><dt><span class="strong">WARNING: This API is experimental and might change in incompatible ways in the next release.</span></dt>
  <dd></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#DEFAULT_BUCKETS">DEFAULT_BUCKETS</a></strong></code>
<div class="block">Default number of buckets.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#FSTCompletionBuilder()">FSTCompletionBuilder</a></strong>()</code>
<div class="block">Creates an <a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst"><code>FSTCompletion</code></a> with default options: 10 buckets, exact match
 promoted to first position and <a href="../../../../../../org/apache/lucene/search/suggest/fst/InMemorySorter.html" title="class in org.apache.lucene.search.suggest.fst"><code>InMemorySorter</code></a> with a comparator obtained from
 <code>BytesRef.getUTF8SortedAsUnicodeComparator()</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#FSTCompletionBuilder(int, org.apache.lucene.search.suggest.fst.BytesRefSorter, int)">FSTCompletionBuilder</a></strong>(int&nbsp;buckets,
                    <a href="../../../../../../org/apache/lucene/search/suggest/fst/BytesRefSorter.html" title="interface in org.apache.lucene.search.suggest.fst">BytesRefSorter</a>&nbsp;sorter,
                    int&nbsp;shareMaxTailLength)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#add(org.apache.lucene.util.BytesRef, int)">add</a></strong>(org.apache.lucene.util.BytesRef&nbsp;utf8,
   int&nbsp;bucket)</code>
<div class="block">Appends a single suggestion and its weight to the internal buffers.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst">FSTCompletion</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#build()">build</a></strong>()</code>
<div class="block">Builds the final automaton from a list of added entries.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULT_BUCKETS">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULT_BUCKETS</h4>
<pre>public static final&nbsp;int DEFAULT_BUCKETS</pre>
<div class="block">Default number of buckets.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../constant-values.html#org.apache.lucene.search.suggest.fst.FSTCompletionBuilder.DEFAULT_BUCKETS">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="FSTCompletionBuilder()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>FSTCompletionBuilder</h4>
<pre>public&nbsp;FSTCompletionBuilder()</pre>
<div class="block">Creates an <a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst"><code>FSTCompletion</code></a> with default options: 10 buckets, exact match
 promoted to first position and <a href="../../../../../../org/apache/lucene/search/suggest/fst/InMemorySorter.html" title="class in org.apache.lucene.search.suggest.fst"><code>InMemorySorter</code></a> with a comparator obtained from
 <code>BytesRef.getUTF8SortedAsUnicodeComparator()</code>.</div>
</li>
</ul>
<a name="FSTCompletionBuilder(int, org.apache.lucene.search.suggest.fst.BytesRefSorter, int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>FSTCompletionBuilder</h4>
<pre>public&nbsp;FSTCompletionBuilder(int&nbsp;buckets,
                    <a href="../../../../../../org/apache/lucene/search/suggest/fst/BytesRefSorter.html" title="interface in org.apache.lucene.search.suggest.fst">BytesRefSorter</a>&nbsp;sorter,
                    int&nbsp;shareMaxTailLength)</pre>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>buckets</code> - The number of buckets for weight discretization. Buckets are used
          in <a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#add(org.apache.lucene.util.BytesRef, int)"><code>add(BytesRef, int)</code></a> and must be smaller than the number
          given here.</dd><dd><code>sorter</code> - <a href="../../../../../../org/apache/lucene/search/suggest/fst/BytesRefSorter.html" title="interface in org.apache.lucene.search.suggest.fst"><code>BytesRefSorter</code></a> used for re-sorting input for the automaton.
          For large inputs, use on-disk sorting implementations. The sorter
          is closed automatically in <a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html#build()"><code>build()</code></a> if it implements
          <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/Closeable.html?is-external=true" title="class or interface in java.io"><code>Closeable</code></a>.</dd><dd><code>shareMaxTailLength</code> - Max shared suffix sharing length.
          
          See the description of this parameter in <code>Builder</code>'s constructor.
          In general, for very large inputs you'll want to construct a non-minimal
          automaton which will be larger, but the construction will take far less ram.
          For minimal automata, set it to <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html?is-external=true#MAX_VALUE" title="class or interface in java.lang"><code>Integer.MAX_VALUE</code></a>.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="add(org.apache.lucene.util.BytesRef, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>add</h4>
<pre>public&nbsp;void&nbsp;add(org.apache.lucene.util.BytesRef&nbsp;utf8,
       int&nbsp;bucket)
         throws <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Appends a single suggestion and its weight to the internal buffers.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>utf8</code> - The suggestion (utf8 representation) to be added. The content is
          copied and the object can be reused.</dd><dd><code>bucket</code> - The bucket to place this suggestion in. Must be non-negative and
          smaller than the number of buckets passed in the constructor.
          Higher numbers indicate suggestions that should be presented
          before suggestions placed in smaller buckets.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
<a name="build()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>build</h4>
<pre>public&nbsp;<a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.html" title="class in org.apache.lucene.search.suggest.fst">FSTCompletion</a>&nbsp;build()
                    throws <a href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Builds the final automaton from a list of added entries. This method may
 take a longer while as it needs to build the automaton.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="http://download.oracle.com/javase/1.5.0/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/FSTCompletionBuilder.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletion.Completion.html" title="class in org.apache.lucene.search.suggest.fst"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../org/apache/lucene/search/suggest/fst/FSTCompletionLookup.html" title="class in org.apache.lucene.search.suggest.fst"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/lucene/search/suggest/fst/FSTCompletionBuilder.html" target="_top">Frames</a></li>
<li><a href="FSTCompletionBuilder.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
          <script src='../../../../../../prettify.js' type='text/javascript'></script>
          <script type='text/javascript'>
            (function(){
              var oldonload = window.onload;
              if (typeof oldonload != 'function') {
                window.onload = prettyPrint;
              } else {
                window.onload = function() {
                  oldonload();
                  prettyPrint();
                }
              }
            })();
          </script>
        </small></p>
</body>
</html>
