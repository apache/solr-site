<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_01) on Mon Jul 02 08:51:58 EDT 2012 -->
<meta http-equiv="Content-Type" content="text/html" charset="utf-8">
<title>org.apache.lucene.util.encoding (Lucene 4.0.0-ALPHA API)</title>
<meta name="date" content="2012-07-02">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="org.apache.lucene.util.encoding (Lucene 4.0.0-ALPHA API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/lucene/util/collections/package-summary.html">Prev Package</a></li>
<li>Next Package</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/lucene/util/encoding/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.apache.lucene.util.encoding</h1>
<div class="docSummary">
<div class="block">Offers various encoders and decoders for integers, as well as the
mechanisms to create new ones.</div>
</div>
<p>See:&nbsp;<a href="#package_description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="packageSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/ChunksIntEncoder.html" title="class in org.apache.lucene.util.encoding">ChunksIntEncoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoder</code></a> which encodes values in chunks.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/DGapIntDecoder.html" title="class in org.apache.lucene.util.encoding">DGapIntDecoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntDecoder.html" title="class in org.apache.lucene.util.encoding"><code>IntDecoder</code></a> which wraps another <a href="../../../../../org/apache/lucene/util/encoding/IntDecoder.html" title="class in org.apache.lucene.util.encoding"><code>IntDecoder</code></a> and reverts the
 d-gap that was encoded by <a href="../../../../../org/apache/lucene/util/encoding/DGapIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>DGapIntEncoder</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/DGapIntEncoder.html" title="class in org.apache.lucene.util.encoding">DGapIntEncoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntEncoderFilter.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoderFilter</code></a> which encodes the gap between the given values,
 rather than the values themselves.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/EightFlagsIntDecoder.html" title="class in org.apache.lucene.util.encoding">EightFlagsIntDecoder</a></td>
<td class="colLast">
<div class="block">Decodes data which was encoded by <a href="../../../../../org/apache/lucene/util/encoding/EightFlagsIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>EightFlagsIntEncoder</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/EightFlagsIntEncoder.html" title="class in org.apache.lucene.util.encoding">EightFlagsIntEncoder</a></td>
<td class="colLast">
<div class="block">A <a href="../../../../../org/apache/lucene/util/encoding/ChunksIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>ChunksIntEncoder</code></a> which encodes data in chunks of 8.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/FourFlagsIntDecoder.html" title="class in org.apache.lucene.util.encoding">FourFlagsIntDecoder</a></td>
<td class="colLast">
<div class="block">Decodes data which was encoded by <a href="../../../../../org/apache/lucene/util/encoding/FourFlagsIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>FourFlagsIntEncoder</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/FourFlagsIntEncoder.html" title="class in org.apache.lucene.util.encoding">FourFlagsIntEncoder</a></td>
<td class="colLast">
<div class="block">A <a href="../../../../../org/apache/lucene/util/encoding/ChunksIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>ChunksIntEncoder</code></a> which encodes values in chunks of 4.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/IntDecoder.html" title="class in org.apache.lucene.util.encoding">IntDecoder</a></td>
<td class="colLast">
<div class="block">Decodes integers from a set <a href="http://download.oracle.com/javase/6/docs/api/java/io/InputStream.html?is-external=true" title="class or interface in java.io"><code>InputStream</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding">IntEncoder</a></td>
<td class="colLast">
<div class="block">Encodes integers to a set <a href="http://download.oracle.com/javase/6/docs/api/java/io/OutputStream.html?is-external=true" title="class or interface in java.io"><code>OutputStream</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/IntEncoderFilter.html" title="class in org.apache.lucene.util.encoding">IntEncoderFilter</a></td>
<td class="colLast">
<div class="block">An abstract implementation of <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoder</code></a> which is served as a filter
 on the values to encode.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/NOnesIntDecoder.html" title="class in org.apache.lucene.util.encoding">NOnesIntDecoder</a></td>
<td class="colLast">
<div class="block">Decodes data which was encoded by <a href="../../../../../org/apache/lucene/util/encoding/NOnesIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>NOnesIntEncoder</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/NOnesIntEncoder.html" title="class in org.apache.lucene.util.encoding">NOnesIntEncoder</a></td>
<td class="colLast">
<div class="block">A variation of <a href="../../../../../org/apache/lucene/util/encoding/FourFlagsIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>FourFlagsIntEncoder</code></a> which translates the data as
 follows:
 
 Values &ge; 2 are trnalsated to <code>value+1</code> (2 &rArr; 3, 3
 &rArr; 4 and so forth).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/SimpleIntDecoder.html" title="class in org.apache.lucene.util.encoding">SimpleIntDecoder</a></td>
<td class="colLast">
<div class="block">A simple stream decoder which can decode values encoded with
 <a href="../../../../../org/apache/lucene/util/encoding/SimpleIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>SimpleIntEncoder</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/SimpleIntEncoder.html" title="class in org.apache.lucene.util.encoding">SimpleIntEncoder</a></td>
<td class="colLast">
<div class="block">A simple <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoder</code></a>, writing an integer as 4 raw bytes.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/SortingIntEncoder.html" title="class in org.apache.lucene.util.encoding">SortingIntEncoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntEncoderFilter.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoderFilter</code></a> which sorts the values to encode in ascending
 order before encoding them.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/UniqueValuesIntEncoder.html" title="class in org.apache.lucene.util.encoding">UniqueValuesIntEncoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntEncoderFilter.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoderFilter</code></a> which ensures only unique values are encoded.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/VInt8IntDecoder.html" title="class in org.apache.lucene.util.encoding">VInt8IntDecoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntDecoder.html" title="class in org.apache.lucene.util.encoding"><code>IntDecoder</code></a> which can decode values encoded by
 <a href="../../../../../org/apache/lucene/util/encoding/VInt8IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>VInt8IntEncoder</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../../org/apache/lucene/util/encoding/VInt8IntEncoder.html" title="class in org.apache.lucene.util.encoding">VInt8IntEncoder</a></td>
<td class="colLast">
<div class="block">An <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoder</code></a> which implements variable length encoding.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package_description">
<!--   -->
</a>
<h2 title="Package org.apache.lucene.util.encoding Description">Package org.apache.lucene.util.encoding Description</h2>
<div class="block">Offers various encoders and decoders for integers, as well as the
mechanisms to create new ones. The super class for all encoders is
<a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoder</code></a> and for most of the
encoders there is a matching <a href="../../../../../org/apache/lucene/util/encoding/IntDecoder.html" title="class in org.apache.lucene.util.encoding"><code>IntDecoder</code></a> implementation (not all
encoders need a decoder).
<p>An encoder encodes the integers that are passed to <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#encode(int)"><code>encode</code></a> into a
set output stream (see <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#reInit(java.io.OutputStream)"><code>reInit</code></a>). One should always call <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#close()"><code>close</code></a> when all
integers have been encoded, to ensure proper finish by the encoder. Some
encoders buffer values in-memory and encode in batches in order to
optimize the encoding, and not closing them may result in loss of
information or corrupt stream.
<p>A proper and typical usage of an encoder looks like this:
<blockquote><pre><code>
int[] data = &lt;the values to encode&gt;
IntEncoder encoder = new VInt8IntEncoder();
OutputStream out = new ByteArrayOutputStream();
encoder.reInit(out);
for (int val : data) {
  encoder.encode(val);
}
encoder.close();

// Print the bytes in binary
byte[] bytes = out.toByteArray();
for (byte b : bytes) {
  System.out.println(Integer.toBinaryString(b));
}
</code></pre></blockquote>
Each encoder also implements <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#createMatchingDecoder()"><code>createMatchingDecoder</code></a> which returns the matching decoder for this encoder.
As mentioned above, not all encoders have a matching decoder (like some
encoder filters which are explained next), however every encoder should
return a decoder following a call to that method. To complete the
example above, one can easily iterate over the decoded values like this:
<blockquote><pre><code>
IntDecoder d = e.createMatchingDecoder();
d.reInit(new ByteArrayInputStream(bytes));
long val;
while ((val = d.decode()) != IntDecoder.EOS) {
  System.out.println(val);
}
</code></pre></blockquote>
<p>Some encoders don't perform any encoding at all, or do not include an
encoding logic. Those are called <a href="../../../../../org/apache/lucene/util/encoding/IntEncoderFilter.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoderFilter</code></a>s. A filter is an
encoder which delegates the encoding task to a given encoder, however
performs additional logic before the values are sent for encoding. An
example is <a href="../../../../../org/apache/lucene/util/encoding/DGapIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>DGapIntEncoder</code></a>
which encodes the gaps between values rather than the values themselves.
Another example is <a href="../../../../../org/apache/lucene/util/encoding/SortingIntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>SortingIntEncoder</code></a> which sorts all the
values in ascending order before they are sent for encoding. This
encoder aggregates the values in its <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#encode(int)"><code>encode</code></a> implementation 
and decoding only happens upon calling <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#close()"><code>close</code></a>.
<h4>Extending IntEncoder</h4>
Extending <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html" title="class in org.apache.lucene.util.encoding"><code>IntEncoder</code></a> is a very
easy task. One only needs to implement <a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#encode(int)"><code>encode</code></a> and
<a href="../../../../../org/apache/lucene/util/encoding/IntEncoder.html#createMatchingDecoder()"><code>createMatchingDecoder</code></a> as the base implementation takes care of
re-initializing the output stream and closing it. The following example
illustrates how can one write an encoder (and a matching decoder) which
'tags' the stream with type/ID of the encoder. Such tagging is important
in scenarios where an application uses different encoders for different
streams, and wants to manage some sort of mapping between an encoder ID
to an IntEncoder/Decoder implementation, so a proper decoder will be
initialized on the fly:
<blockquote><pre><code>
public class TaggingIntEncoder extends IntEncoderFilter {
  
  public TaggingIntEncoder(IntEncoder encoder) {
    super(encoder);
  }
  
  &#64;Override
  public void encode(int value) throws IOException {
    encoder.encode(value);
  }

  &#64;Override
  public IntDecoder createMatchingDecoder() {
    return new TaggingIntDecoder();
  }
        
  &#64;Override
  public void reInit(OutputStream out) {
    super.reInit(os);
    // Assumes the application has a static EncodersMap class which is able to 
    // return a unique ID for a given encoder.
    int encoderID = EncodersMap.getID(encoder);
    this.out.write(encoderID);
  }

  &#64;Override
  public String toString() {
    return "Tagging (" + encoder.toString() + ")";
  }

}
</code></pre></blockquote>
And the matching decoder:
<blockquote><pre><code>
public class TaggingIntDecoder extends IntDecoder {
  
  // Will be initialized upon calling reInit.
  private IntDecoder decoder;
  
  &#64;Override
  public void reInit(InputStream in) {
    super.reInit(in);
    
    // Read the ID of the encoder that tagged this stream.
    int encoderID = in.read();
    
    // Assumes EncodersMap can return the proper IntEncoder given the ID.
    decoder = EncodersMap.getEncoder(encoderID).createMatchingDecoder();
  }
        
  &#64;Override
  public long decode() throws IOException {
    return decoder.decode();
  }

  &#64;Override
  public String toString() {
    return "Tagging (" + decoder == null ? "none" : decoder.toString() + ")";
  }

}
</code></pre></blockquote>
The example implements <code>TaggingIntEncoder</code> as a filter over another 
encoder. Even though it does not do any filtering on the actual values, it feels 
right to present it as a filter. Anyway, this is just an example code and one 
can choose to implement it however it makes sense to the application. For 
simplicity, error checking was omitted from the sample code.</div>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../org/apache/lucene/util/collections/package-summary.html">Prev Package</a></li>
<li>Next Package</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?org/apache/lucene/util/encoding/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<p class="legalCopy"><small>
          <address>Copyright &copy; 2000-2012 Apache Software Foundation.  All Rights Reserved.</address>
          <script src='../../../../../prettify.js' type='text/javascript'></script>
          <script type='text/javascript'>
            (function(){
              var oldonload = window.onload;
              if (typeof oldonload != 'function') {
                window.onload = prettyPrint;
              } else {
                window.onload = function() {
                  oldonload();
                  prettyPrint();
                }
              }
            })();
          </script>
        </small></p>
</body>
</html>
