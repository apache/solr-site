---
cve: CVE-2025-24814
jira: SOLR-16781
severity: moderate
category:
  - solr/vex
vulnerable_component:
  name: Apache Solr
  versions:
    - fixed: 9.8.0
analysis:
  state: exploitable
  response:
    - update
title: "Apache Solr: Core-creation with \"trusted\" configset can use arbitrary untrusted files"
---
Core creation allows users to replace "trusted" configset files with arbitrary configuration

Solr instances are vulnerable if they:

1. use the `FileSystemConfigSetService` component (the default in "standalone" or "user-managed" mode), and
2. run without authentication and authorization enabled

In this configuration, attackers can exploit a privilege escalation issue by replacing individual "trusted" configset files with potentially untrusted files from elsewhere on the filesystem.
These replacements are incorrectly treated as "trusted" and can leverage `<lib>` tags to add arbitrary code to Solr's classpath, potentially allowing malicious plugins or components to be loaded.

This issue affects all Apache Solr versions up through Solr 9.7.

#### Mitigation

Users can protect against the vulnerability by enabling authentication and authorization on their Solr clusters or switching to SolrCloud (and away from "FileSystemConfigSetService").
Users are also recommended to upgrade to Solr 9.8.0, which mitigates this issue by disabling use of "<lib>" tags by default.

#### Credit
pwn null (reporter)
