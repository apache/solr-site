---
cve: CVE-2024-51504
jira: SOLR-17809
severity: important
category:
  - solr/vex
vulnerable_component:
  name: zookeeper
  versions:
    - introduced: 3.9.0
      last_affected: 3.9.2
impacted_component:
  name: Apache Solr
  versions:
    - introduced: 9.4.0
      fixed: 9.9.0
analysis:
  state: not_affected
  justification: requires_configuration
title: "Apache ZooKeeper: Authentication bypass with IP-based authentication in Admin Server"
---

CVE-2024-51504 is **not** considered exploitable in typical **production** deployments of Apache Solr (versions 3.4.0 to 3.8.1).
Successful exploitation requires a very specific and non-standard configuration.
The following conditions **must all be met**:

* Solr must be deployed in [SolrCloud mode](https://solr.apache.org/guide/solr/latest/deployment-guide/cluster-types.html#solrcloud-mode), which relies on ZooKeeper for coordination.
* The **embedded ZooKeeper server** must be in use: a setup that is explicitly discouraged for production.
  Solr emits a warning when this configuration is detected, and it is not commonly used outside of development or experimentation.
* The **ZooKeeper Admin Server** must be **manually enabled** in the ZooKeeper configuration file (`server/solr/zoo.cfg`).
  By default, this feature is disabled:

```properties
# Disable ZK AdminServer since we do not use it
admin.enableServer=false
```

Because these conditions are highly unlikely in secure, production-grade environments,
the Solr community considers this vulnerability **non-exploitable under standard operating conditions**.
