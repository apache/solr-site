Title: CVE-2025-54988: Apache Solr extraction module vulnerable to XXE attacks via XFA content in PDFs
category: solr/security
cve: CVE-2025-54988

**Severity**
high

**Versions Affected**

- Apache Solr 6.2.0 through 9.10.0 (when using the extraction module)

**Description**

XXE (XML External Entity) vulnerability in Apache Tika affects Solr's extraction module (SolrCell)

Apache Solr versions 6.2.0 through 9.10.0 that use the extraction module (also known as SolrCell) with the 'local' extraction backend are vulnerable to XXE (XML External Entity) injection attacks when processing PDF files containing crafted XFA (XML Forms Architecture) content. This vulnerability exists because these Solr versions use Apache Tika versions 1.13 through 1.28.5, all of which are affected by CVE-2025-54988.

An attacker with the ability to submit PDF files for extraction could exploit this vulnerability to read arbitrary files from the server, perform server-side request forgery (SSRF), or cause denial of service.

**Note**: This vulnerability only affects Solr deployments that:

1. Use the extraction module (SolrCell) for extracting content from documents
2. Use the 'local' extraction backend (the default for the extraction module)
3. Allow untrusted users to submit PDF files for extraction

Solr deployments that do not use the extraction module are not affected. Additionally, deployments using the TikaServer extraction backend (recommended since Solr 9.10.0) may have different exposure depending on their TikaServer configuration.

**Mitigation**

Users of Solr 6.2.0 through 9.10.0 who use the extraction module can protect themselves by configuring a custom parseContext XML file to disable XFA parsing in PDFs.

To mitigate this vulnerability, create or modify the parseContext configuration file (typically `parseContext.xml` in your configset's `conf/` directory) with the following content:

```xml
<?xml version="1.0" ?>
<entries>
  <entry class="org.apache.tika.parser.pdf.PDFParserConfig" impl="org.apache.tika.parser.pdf.PDFParserConfig">
    <!-- Disable XFA parsing to mitigate CVE-2025-54988 -->
    <property name="extractAcroFormContent" value="false"/>
  </entry>
</entries>
```

Then configure your extraction request handler in `solrconfig.xml` to use this parseContext file:

```xml
<requestHandler name="/update/extract" class="org.apache.solr.handler.extraction.ExtractingRequestHandler">
  <str name="parseContext.config">parseContext.xml</str>
  <str name="extraction.backend">local</str>
</requestHandler>
```

Users are also recommended to upgrade to Solr 9.10.1 or later (once available), which will include this mitigation by default at the code level.

**Credit**

Apache Tika Security Team (CVE-2025-54988 discovery)

**References**

* CVE - [CVE-2025-54988](https://www.cve.org/CVERecord?id=CVE-2025-54988)
* Apache Tika - [CVE-2025-54988 Advisory](https://lists.apache.org/thread/tdqvvx28f83o4px8xnoso1xmo5h0d0dl)
* SOLR-17888 - [SOLR-17888](https://issues.apache.org/jira/browse/SOLR-17888)  
