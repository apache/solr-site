Title: CVE-2021-29262: Misapplied Zookeeper ACLs can result in leakage of configured authentication and authorization settings
category: solr/security
cve: CVE-2020-29262

**Severity:**
High

**Versions Affected:**
7.0.0 to 7.7.3
8.0.0 to 8.8.1

**Description:**
When starting Apache Solr versions prior to 8.8.2, configured with the SaslZkACLProvider or VMParamsAllAndReadonlyDigestZkACLProvider and no existing security.json znode, if the optional read-only user is configured then Solr would not treat that node as a sensitive path and would allow it to be readable.
Additionally, with any ZkACLProvider, if the security.json is already present, Solr will not automatically update the ACLs.

**Mitigation:**
Any of the following are enough to prevent this vulnerability:

* Manually set appropriate ACLs on /security.json znode.
* Upgrade to `Solr 8.8.2` or greater.
* If upgrading is not an option, consider applying the patch in [SOLR-15249](https://issues.apache.org/jira/browse/SOLR-15249)
* Ensure that any access to zookeeper is only by trusted application.

**Credit:**
Timothy Potter and Mike Drob, Apple Cloud Services

**References:**
[SOLR-15249](https://issues.apache.org/jira/browse/SOLR-15249): CVE-2021-29262: Misapplied Zookeeper ACLs can result in leakage of configured authentication and authorization settings
 
